/**** Start of imports. If edited, may not auto-convert in the playground. ****/
var uvic = /* color: #98ff00 */ee.Geometry.Point([-123.31238346994817, 48.4641269931745]),
    sent2 = ee.ImageCollection("COPERNICUS/S2_SR"),
    water = /* color: #0916f7 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-123.26455275099107, 48.47042449952259],
                  [-123.26455275099107, 48.46649781222927],
                  [-123.2567421583397, 48.466554722910566],
                  [-123.25682798902818, 48.47048140580046]]]),
            {
              "landcover": 0,
              "label": "water",
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-123.45910850874452, 48.36314286349857],
                  [-123.45945183149843, 48.33188274335729],
                  [-123.37671104780702, 48.331426249232926],
                  [-123.37808433882265, 48.362230431000995]]]),
            {
              "landcover": 0,
              "label": "water",
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-123.8516112730133, 48.06311514153511],
                  [-123.85109628888245, 48.05405120410717],
                  [-123.81762232037659, 48.0545101760014],
                  [-123.81848062726135, 48.063000418121796]]]),
            {
              "landcover": 0,
              "label": "water",
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-123.26345771785925, 48.66367945826989],
                  [-123.26277107235144, 48.64417457933226],
                  [-123.21487754818152, 48.64417457933226],
                  [-123.2164225005741, 48.66401959269322]]]),
            {
              "landcover": 0,
              "label": "water",
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-123.12213280289576, 48.32387942829918],
                  [-123.11938622086451, 48.25877760014581],
                  [-122.94051506607936, 48.25900617271958],
                  [-122.99956657975123, 48.32776007232502]]]),
            {
              "landcover": 0,
              "label": "water",
              "system:index": "4"
            })]),
    artificial = /* color: #97999b */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-123.36962474394784, 48.43368255090056],
                  [-123.36959792185769, 48.43298493921043],
                  [-123.36937798071847, 48.432960024330065],
                  [-123.36935115862832, 48.43289239816464],
                  [-123.36829436827645, 48.43283544974499],
                  [-123.36744679022775, 48.432842568300934],
                  [-123.36752189208016, 48.433928136409996],
                  [-123.36845530081735, 48.43389966278857],
                  [-123.36846066523538, 48.433639840256035],
                  [-123.3688790898417, 48.43346543808485]]]),
            {
              "landcover": 1,
              "label": "artificial",
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-123.43636213439804, 48.64902958810601],
                  [-123.4371667971025, 48.649036676322744],
                  [-123.43714533943039, 48.648646822921876],
                  [-123.43654452461105, 48.64841999773806],
                  [-123.4363728632341, 48.64711573313113],
                  [-123.43491374153, 48.64712282161691],
                  [-123.43495665687423, 48.649320204175766],
                  [-123.43638359207016, 48.64939108588992]]]),
            {
              "landcover": 1,
              "label": "artificial",
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-123.50900422162447, 48.44213536586237],
                  [-123.51019512242708, 48.44010690812986],
                  [-123.5095513922635, 48.43913179611104],
                  [-123.50733052319917, 48.43866914517542],
                  [-123.50547443456087, 48.441473456979566]]]),
            {
              "landcover": 1,
              "label": "artificial",
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-123.39117370253727, 48.416704295187266],
                  [-123.39124880438969, 48.41624856091281],
                  [-123.38799796706364, 48.41638385745194],
                  [-123.38812671309636, 48.415344201115325],
                  [-123.39134536391423, 48.415159054606065],
                  [-123.3913239062421, 48.41471042757595],
                  [-123.38690362578556, 48.41496678636361],
                  [-123.38521919852421, 48.415878273806754],
                  [-123.38580928450749, 48.41770832034619],
                  [-123.38763318663761, 48.41760151010158],
                  [-123.3879550517194, 48.41691079843544]]]),
            {
              "landcover": 1,
              "label": "artificial",
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-123.33786860075047, 48.44792330546067],
                  [-123.3362163599973, 48.44607299672877],
                  [-123.33880200948765, 48.445197634877495],
                  [-123.33784714307835, 48.44419415273106],
                  [-123.33426371183445, 48.44563175930742],
                  [-123.3335877951627, 48.44785214098676]]]),
            {
              "landcover": 1,
              "label": "artificial",
              "system:index": "4"
            })]),
    herbaceous = /* color: #2cff0c */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-123.45467361465938, 48.640812084544216],
                  [-123.45475944534786, 48.635820919537096],
                  [-123.44467433945186, 48.63583509968263],
                  [-123.44469579712398, 48.637777741943374],
                  [-123.44752820984371, 48.63783446030149],
                  [-123.44754966751583, 48.63865686932773],
                  [-123.44469579712398, 48.63945090669985],
                  [-123.44467433945186, 48.64079790579765]]]),
            {
              "landcover1": 1,
              "label": "herbaceous",
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-123.38677955016135, 48.55771732393704],
                  [-123.38592124327658, 48.554507550353556],
                  [-123.37660861357688, 48.55445073836757],
                  [-123.37665152892112, 48.55771732393704]]]),
            {
              "landcover1": 1,
              "label": "herbaceous",
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-123.13972529475413, 48.13253225514902],
                  [-123.14268645350657, 48.13099987872252],
                  [-123.14257916514597, 48.1294101688719],
                  [-123.14161356990061, 48.12877999999602],
                  [-123.14131316249095, 48.12814982338761],
                  [-123.13929614131175, 48.12806388961464],
                  [-123.13794430796824, 48.129753894090484],
                  [-123.13805159632884, 48.13032676434238],
                  [-123.1368928820344, 48.131515449727395],
                  [-123.13697871272288, 48.13244632870914]]]),
            {
              "landcover1": 1,
              "label": "herbaceous",
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-123.06661843815031, 48.10523440020036],
                  [-123.0668330148715, 48.10559261577354],
                  [-123.06865691700163, 48.10553530144957],
                  [-123.06921481647673, 48.104876182130646],
                  [-123.0704164461154, 48.102812797444635],
                  [-123.07037353077116, 48.101609118126675],
                  [-123.06470870533171, 48.10169509615552],
                  [-123.06470870533171, 48.10519141416379]]]),
            {
              "landcover1": 1,
              "label": "herbaceous",
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-123.40366416521579, 48.47355200664943],
                  [-123.40351396151095, 48.472115190545814],
                  [-123.40226941652804, 48.471816441494155],
                  [-123.39902930803805, 48.47207251221755],
                  [-123.39842849321872, 48.4732817176182],
                  [-123.3989649350217, 48.47386497109731]]]),
            {
              "landcover1": 1,
              "label": "herbaceous",
              "system:index": "4"
            })]),
    woody = /* color: #025006 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-123.61661529370662, 48.486760534171715],
                  [-123.61670112439509, 48.48263598736707],
                  [-123.60429858991023, 48.48240841640058],
                  [-123.60485648938533, 48.48619165110582],
                  [-123.60648727246638, 48.487556959743436]]]),
            {
              "landcover": 3,
              "label": "woody",
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-123.70200725054261, 48.345795029010205],
                  [-123.70213599657532, 48.33980485332642],
                  [-123.6917933986139, 48.340204220273044],
                  [-123.69187922930237, 48.34570946002828]]]),
            {
              "landcover": 3,
              "label": "woody",
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-123.24245683688915, 47.978764655903106],
                  [-123.24211351413524, 47.96554818192983],
                  [-123.21155778903758, 47.96566312236954],
                  [-123.21413270969188, 47.980430840747914]]]),
            {
              "landcover": 3,
              "label": "woody",
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-123.16490205640339, 48.7828321867998],
                  [-123.16387208814167, 48.77480071754792],
                  [-123.1458476435616, 48.77491384575539],
                  [-123.14687761182331, 48.782945296908]]]),
            {
              "landcover": 3,
              "label": "woody",
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-123.6919601914161, 48.58078393536479],
                  [-123.69178853003915, 48.591968838777404],
                  [-123.69942746131356, 48.59185529889653],
                  [-123.69882664649423, 48.58021610775187]]]),
            {
              "landcover": 3,
              "label": "woody",
              "system:index": "4"
            })]),
    baresoil = /* color: #ffe600 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-123.48766956924824, 48.40469930876359],
                  [-123.48709021210102, 48.406059687579926],
                  [-123.4865644991341, 48.40693572378696],
                  [-123.48963294624714, 48.40776901251682],
                  [-123.4915534079018, 48.40564659210053]]]),
            {
              "landcover": 4,
              "label": "baresoil",
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-123.00650665467913, 48.5249477250151],
                  [-123.00633499330218, 48.522318569084604],
                  [-123.00249406999285, 48.52241805314465],
                  [-123.00335237687761, 48.52486245723438]]]),
            {
              "landcover": 4,
              "label": "baresoil",
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-123.5704740060678, 48.121672255684544],
                  [-123.5704203618875, 48.1207196948784],
                  [-123.56817267073302, 48.1207161137894],
                  [-123.5681512130609, 48.12162212134563]]]),
            {
              "landcover": 4,
              "label": "baresoil",
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-123.5496933514253, 48.44944585940456],
                  [-123.55017614904799, 48.44802971007912],
                  [-123.54936075750746, 48.44759560614665],
                  [-123.5492963844911, 48.447211314323106],
                  [-123.54867411199965, 48.446891068915455],
                  [-123.54809475485243, 48.446919535255695],
                  [-123.54658198896803, 48.44752444121354],
                  [-123.54730082098402, 48.44836418106988],
                  [-123.54881358686842, 48.44926795336683]]]),
            {
              "landcover": 4,
              "label": "baresoil",
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-123.43709539491883, 48.470356502800875],
                  [-123.4393055351471, 48.468151332428704],
                  [-123.43879055101624, 48.46792369648226],
                  [-123.43719195444336, 48.46767471849666],
                  [-123.43675207216492, 48.467816991780865],
                  [-123.43592595178833, 48.46827226360995],
                  [-123.43504618723145, 48.46851412510787],
                  [-123.43508910257569, 48.46977320899153]]]),
            {
              "landcover": 4,
              "label": "baresoil",
              "system:index": "4"
            })]),
    desiccated = /* color: #a7914b */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-123.44333267746856, 48.65486989866371],
                  [-123.44346142350128, 48.65211991391868],
                  [-123.44077921448638, 48.65139695488587],
                  [-123.44002819596221, 48.65243177539923],
                  [-123.43580103455474, 48.651751347863886],
                  [-123.4355220848172, 48.65491242302332]]]),
            {
              "landcover": 5,
              "label": "desiccated",
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-123.56672320467193, 48.326693554463425],
                  [-123.56559667688568, 48.325716267299924],
                  [-123.56447014909942, 48.32623701388564],
                  [-123.56529626947601, 48.326900423067265],
                  [-123.56625113588531, 48.326978890249215]]]),
            {
              "landcover": 5,
              "label": "desiccated",
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-123.51504605023328, 48.12220674733583],
                  [-123.51519625393811, 48.12117541324522],
                  [-123.51219217984143, 48.12064541406101],
                  [-123.51161282269422, 48.12183432352496]]]),
            {
              "landcover": 5,
              "label": "desiccated",
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-123.0054297233897, 48.526767408729135],
                  [-123.00526342643077, 48.52565540343866],
                  [-123.00395987284953, 48.52540315602961],
                  [-123.0036648298579, 48.52612436711349],
                  [-123.00394914401348, 48.52685267330266]]]),
            {
              "landcover": 5,
              "label": "desiccated",
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-123.02562339716425, 48.528470127828676],
                  [-123.02555365972987, 48.527013551498676],
                  [-123.02514059954157, 48.52683947006143],
                  [-123.02410526686182, 48.52686078618794],
                  [-123.02407308035365, 48.52772408177142],
                  [-123.02411063127985, 48.528466575254434]]]),
            {
              "landcover": 5,
              "label": "desiccated",
              "system:index": "4"
            })]);
/***** End of imports. If edited, may not auto-convert in the playground. *****/

// This is our first line of code. It defines the image collection to work with using the sent2 variable from the previous step
var image = ee.Image(sent2
// We will then include a filter to get only images in the date range we are interested in
.filterDate("2019-05-01", "2019-09-01")
// Next we include a geographic filter to narrow the search to images at the location of our study area - uvic
.filterBounds(water)
// Next we will also sort the collection by a metadata property, in this case cloud cover.
//Recall from the Image Properties table that the nomenclature for Cloud Cover for Sentinel-2 is CLOUD_COVERAGE_ASSESSMENT

.sort("CLOUD_COVERAGE_ASSESSMENT")
// Now select the first image out of this collection - i.e. the most cloud free image in the date range
.first());
// And print the image to the console.
print("Sentinel-2 image of Victoria, 2019", image);
// Define visualization parameters in a JavaScript dictionary for true colour rendering. Bands 4,3 and 2 needed for RGB. min/max values based on Level 2A DN value range looking at water (low radiance).
var trueColour = {
bands: ["B4", "B3", "B2"],
min: 0,
max: 2000
};
// Add the image to the map, using the visualization parameters.
Map.addLayer(image, trueColour, "true-colour image");

var newfc = water.merge(artificial).merge(herbaceous).merge(woody).merge(desiccated).merge(baresoil)
print(newfc)

//Define the bands to be used to train your data
var bands = ['B2', 'B3', 'B4', 'B5', 'B6', 'B7', 'B8', 'B8A'];
// Overlay the polygons on the imagery to get training.
var training = image.select(bands).sampleRegions({
  collection: newfc,
  properties: ['landcover'],
  scale: 20
});
//Train the classifier
var classifier = ee.Classifier.cart().train({
features: training,
classProperty: 'landcover',
inputProperties: bands});
//Run the Classification

var classified = image.select(bands).classify(classifier);
//Display the Classification
Map.addLayer(classified,
{min: 0, max: 5, palette: ['#1b21d6', '#df20d9', '#41f015', '#2c772f',
'#ffc522', '#755342']},
'classification');
